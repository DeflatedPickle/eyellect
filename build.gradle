//file:noinspection GroovyAssignabilityCheck
plugins {
	id 'java-library'

	id 'org.jetbrains.kotlin.multiplatform'

	id 'maven-publish'

	id 'com.diffplug.spotless'

	id 'org.jetbrains.dokka'
}

group "$group"
archivesBaseName = "$name"
version "$version"

repositories {
	mavenCentral()
	mavenLocal()

	maven { url 'https://jitpack.io' }
}

kotlin {
	jvm().compilations.all {
		kotlinOptions {
			jvmTarget = "$jvmTarget"
		}
	}
	js() {
		nodejs()
		browser()
	}
	linuxX64()
	macosX64()
	mingwX64()
	wasm32()

	sourceSets {
		all {
			languageSettings.useExperimentalAnnotation("kotlin.RequiresOptIn")
		}

		jvmMain {
			dependsOn(commonMain)

			dependencies {
			}
		}
	}
}

wrapper {
	gradleVersion = "$gradleVersion"
	distributionType = "ALL"
}

spotless {
	ratchetFrom "origin/$branch"

	groovyGradle {
		target '*.gradle'
		greclipse()
	}

	kotlin {
		ktlint("$ktlintVersion")

		licenseHeader "$licenseHeader\n\n"
	}

	format 'misc', {
		target '*.md', '.gitignore'

		trimTrailingWhitespace()
		indentWithTabs()
		endWithNewline()
	}
}